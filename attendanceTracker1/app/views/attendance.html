<div class="container" ng-controller="AttendanceController" ng-init="initAttendance()">
    <div class="top-nav">
  <button class="menu-toggle" ng-click="toggleSidebar()">â˜°</button>
  <h2 class="welcome-text">Welcome, {{username}} !</h2>
  <button ng-click="logout()" class="logout-btn">Logout</button>
</div>

<div class="sidebar" ng-show="sidebarOpen" ng-class="{'open': sidebarOpen}">
  <ul>
    <li>
      <button class="sidebar-btn" ng-click="navigateToLeaveHistory()">Leave History</button>
    </li>
  </ul>
</div>

  <div class="actions">
    <div class="row">
      <button ng-click="checkIn()" class="checkin">âœ… Check In</button>
      <button ng-click="checkOut()" class="checkout">ğŸ”´ Check Out</button>
    </div>
    <div class="row">
      <button ng-click="startBreak()" class="break">ğŸ½ï¸ Break</button>
      <button ng-click="endBreak()" class="back">â†©ï¸ Back</button>
    </div>
  </div>

  <h3>Today's Attendance ğŸŸ¢ :</h3>
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Check In</th>
        <th>Break Start</th>
        <th>Break End</th>
        <th>Check Out</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>{{today}}</td>
        <td>{{todayRecord.checkIn || '-'}}</td>
        <td>{{todayRecord.breakStart || '-'}}</td>
        <td>{{todayRecord.breakEnd || '-'}}</td>
        <td>{{todayRecord.checkOut || '-'}}</td>
      </tr>
    </tbody>
  </table>

  <h4>Last 7 Days Attendance ğŸ—“ï¸ -</h4>
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Check In</th>
        <th>Break Start</th>
        <th>Break End</th>
        <th>Check Out</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="rec in last7Days">
        <td>{{rec.date}}</td>
        <td>{{rec.checkIn || '-'}}</td>
        <td>{{rec.breakStart || '-'}}</td>
        <td>{{rec.breakEnd || '-'}}</td>
        <td>{{rec.checkOut || '-'}}</td>
      </tr>
    </tbody>
  </table>

  <div class="leave-section">
    <div class="leave-header" >
      <h3>Applying for Leave ğŸ“ :</h3>
      <button ng-click="openLeaveModal()" class="apply-leave-btn">Leave form</button>
    </div>
  </div>

  <h3>Attendance Statistics ğŸ“Š :</h3>
<h4>Attendance by Date ğŸ“…</h4>
<div class="picker-section">
  <label>Select Date: </label>
  <input type="date" ng-model="selectedDate" ng-change="viewDailyAttendance()" />
</div>

<table>
  <thead>
    <tr>
      <th>Date</th>
      <th>Check In</th>
      <th>Break Start</th>
      <th>Break End</th>
      <th>Check Out</th>
    </tr>
  </thead>
  <tbody ng-if="dailyRecord.checkIn ">
    <tr>
      <td>{{selectedDate | date:'yyyy-MM-dd'}}</td>
      <td>{{dailyRecord.checkIn || '-'}}</td>
      <td>{{dailyRecord.breakStart || '-'}}</td>
      <td>{{dailyRecord.breakEnd || '-'}}</td>
      <td>{{dailyRecord.checkOut || '-'}}</td>
    </tr>
  </tbody>
  <tbody ng-if="!(dailyRecord.checkIn || dailyRecord.checkOut || dailyRecord.breakStart || dailyRecord.breakEnd)">
    <tr>
      <td colspan="5">No records found</td>
    </tr>
  </tbody>
</table>

  <h4>Attendance for a Month ğŸ“… -</h4>
  <div class="picker-section">
    <label>Select Month ğŸ—“ï¸ : </label>

    <input type="month" ng-model="selectedMonth" ng-change="updateMonthAttendance()" />
  </div>
  <div class="summary">
    <div class="summary-text">
      <p>Total Working Days: <span>{{monthStats.total}}</span></p>
      <p>Days Present: <span>{{monthStats.present}}</span></p>
      <p>Attendance %: <span>{{monthStats.percent}}%</span></p>
    </div>
    <div id="chartContainer">
      <canvas id="attendanceChart"></canvas>
    </div>
  </div>
<div id="leaveModal" class="modal" ng-class="{active: showLeaveModal}">
  <div class="modal-content">
    <span class="close-btn" ng-click="closeLeaveModal()">&times;</span>
    <h3>Apply for Leave</h3>
    <form ng-submit="submitLeaveForm()">
      <label>Leave Type:</label>
      <select ng-model="leaveForm.leaveType" required>
        <option value="">Select type</option>
        <option value="full">Full Day</option>
        <option value="sick">Sick Leave</option>
        <option value="personal">Personal Leave</option>
        <option value="vacation">Vacation</option>
      </select>

      <label>From Date:</label>
      <input type="date" ng-model="leaveForm.fromDate" required />

      <label>To Date:</label>
      <input type="date" ng-model="leaveForm.toDate" required />

      <label>Reason:</label>
      <input type="text" ng-model="leaveForm.reason" required />

      <label>Description:</label>
      <textarea ng-model="leaveForm.description" rows="4"></textarea>

      <div class="form-buttons">
        <button type="reset" class="cancel-btn" ng-click="closeLeaveModal()">Cancel</button>
        <button type="submit" class="submit-btn">Submit</button>
      </div>
    </form>
  </div>
</div>


  <h3 id="leaveHistorySection">Your Leave History ğŸ“‹ :</h3>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>From</th>
        <th>To</th>
        <th>Reason</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="leave in leaveHistory">
        <td>{{leave.leaveType}}</td>
        <td>{{leave.fromDate}}</td>
        <td>{{leave.toDate}}</td>
        <td>{{leave.reason}}</td>
        <td>{{leave.status}}</td>
        <td>
          <button ng-click="editLeave($index)">âœï¸</button>
          <button ng-click="deleteLeave($index)">ğŸ—‘ï¸</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
