<!-- app/views/admin.html -->
<div class="container" ng-init="initAdmin()" ng-controller="AdminController">
    <div class="top-nav">
        <button class="menu-toggle" ng-click="toggleSidebar()">â˜°</button>
        <h2 class="welcome-text">Welcome, Admin</h2>
        <button ng-click="logout()" class="logout-btn">Logout</button>
    </div>

    <div class="sidebar" ng-show="sidebarOpen" ng-class="{'open': sidebarOpen}">
        <ul>
            <li>
                <button class="sidebar-btn" ng-click="navigateToLeaveHistory()">Leave History</button>
            </li>
        </ul>
    </div>


    <h4>View Attendance by Date ğŸ“… :</h4>

    <div class="picker-section">
        <label for="adminDateSelector">Select Date:</label>
        <input type="date" id="adminDateSelector" ng-model="selectedDate" ng-change="loadAttendanceByDate()"/>
    </div>

    <table>
        <thead>
        <tr>
            <th>User</th>
            <th>Check In</th>
            <th>Break Start</th>
            <th>Break End</th>
            <th>Check Out</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="rec in attendanceByDate">
            <td>{{rec.user}}</td>
            <td>{{rec.checkIn || '-'}}</td>
            <td>{{rec.breakStart || '-'}}</td>
            <td>{{rec.breakEnd || '-'}}</td>
            <td>{{rec.checkOut || '-'}}</td>
        </tr>
        </tbody>
    </table>


    <div class="staff-presence-section">
        <div class="chart-container">
            <h4>Today's Staff Presence ğŸŸ¢</h4>
            <canvas id="staffPresenceChart"></canvas>
        </div>

        <div class="table-container">
            <h4>Staff Status Table ğŸ“‹</h4>
            <div id="staffTableContainer" class="handsontable-wrapper"></div>
        </div>
    </div>
    <div class="chart-container">
        <h4>Attendance Over Last 7 Days ğŸ“ˆ</h4>
        <div id="attendanceTrendChart"></div>
    </div>
    <h3>Leave Approval Panel ğŸ“‹ :</h3>
    <table>
        <thead>
        <tr>
            <th>User</th>
            <th>Type</th>
            <th>From</th>
            <th>To</th>
            <th>Reason</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="req in pendingLeaves">
            <td>{{req.user}}</td>
            <td>{{req.leaveType}}</td>
            <td>{{req.fromDate}}</td>
            <td>{{req.toDate}}</td>
            <td>{{req.reason}}</td>
            <td>{{req.status}}</td>
            <td>
                <button ng-click="approveLeave(req.user, req.index)">âœ…</button>
                <button ng-click="rejectLeave(req.user, req.index)">âŒ</button>
            </td>
        </tr>
        </tbody>
    </table>
    <h3 id="leaveHistorySection">Leave History ğŸ“‹ :</h3>
    <table>
        <thead>
        <tr>
            <th>User</th>
            <th>Type</th>
            <th>From</th>
            <th>To</th>
            <th>Reason</th>
            <th>Status</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="req in leaveHistory">
            <td>{{req.user}}</td>
            <td>{{req.leaveType}}</td>
            <td>{{req.fromDate}}</td>
            <td>{{req.toDate}}</td>
            <td>{{req.reason}}</td>
            <td>{{req.status}}</td>
        </tr>
        </tbody>
    </table>



  <div ng-repeat="(status, items) in groupedLeaveHistoryData">

        <h4>{{ status }} Leaves</h4>
        <ul>
            <li ng-repeat="item in items">{{ item.user }} - {{ item.leaveType }}</li>
        </ul>
    </div>

</div>
